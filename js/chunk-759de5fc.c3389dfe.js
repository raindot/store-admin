(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-759de5fc"],{1276:function(t,e,n){"use strict";var a=n("d784"),o=n("44e7"),i=n("825a"),s=n("1d80"),r=n("4840"),l=n("8aa5"),c=n("50c4"),d=n("14c3"),u=n("9263"),p=n("d039"),m=[].push,f=Math.min,v=4294967295,h=!p((function(){return!RegExp(v,"y")}));a("split",2,(function(t,e,n){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var a=String(s(this)),i=void 0===n?v:n>>>0;if(0===i)return[];if(void 0===t)return[a];if(!o(t))return e.call(a,t,i);var r,l,c,d=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,h=new RegExp(t.source,p+"g");while(r=u.call(h,a)){if(l=h.lastIndex,l>f&&(d.push(a.slice(f,r.index)),r.length>1&&r.index<a.length&&m.apply(d,r.slice(1)),c=r[0].length,f=l,d.length>=i))break;h.lastIndex===r.index&&h.lastIndex++}return f===a.length?!c&&h.test("")||d.push(""):d.push(a.slice(f)),d.length>i?d.slice(0,i):d}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var o=s(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,o,n):a.call(String(o),e,n)},function(t,o){var s=n(a,t,this,o,a!==e);if(s.done)return s.value;var u=i(t),p=String(this),m=r(u,RegExp),b=u.unicode,g=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(h?"y":"g"),C=new m(h?u:"^(?:"+u.source+")",g),_=void 0===o?v:o>>>0;if(0===_)return[];if(0===p.length)return null===d(C,p)?[p]:[];var w=0,x=0,y=[];while(x<p.length){C.lastIndex=h?x:0;var $,k=d(C,h?p:p.slice(x));if(null===k||($=f(c(C.lastIndex+(h?0:x)),p.length))===w)x=l(p,x,b);else{if(y.push(p.slice(w,x)),y.length===_)return y;for(var M=1;M<=k.length-1;M++)if(y.push(k[M]),y.length===_)return y;x=w=$}}return y.push(p.slice(w)),y}]}),!h)},1799:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("nav",{attrs:{"aria-label":"Page navigation example"}},[n("ul",{staticClass:"pagination"},[n("li",{staticClass:"page-item",class:t.pagination.current_page-1===0?"disabled":"",on:{click:function(e){return t.emitPage(t.pagination.current_page-1)}}},[t._m(0)]),t._l(t.pagination.total_pages,(function(e){return n("li",{key:e,staticClass:"page-item",class:t.pagination.current_page===e?"active":"",on:{click:function(n){return t.emitPage(e)}}},[n("a",{staticClass:"page-link",attrs:{href:"#"}},[t._v(t._s(e))])])})),n("li",{staticClass:"page-item",class:t.pagination.current_page+1>t.pagination.total_pages?"disabled":"",on:{click:function(e){return t.emitPage(t.pagination.current_page+1)}}},[t._m(1)])],2)])},o=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Previous"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Next"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])])}],i={props:["pagination"],data:function(){return{}},methods:{emitPage:function(t){t>0&&t<=this.pagination.total_pages&&this.$emit("emit-page",t)}}},s=i,r=n("2877"),l=Object(r["a"])(s,a,o,!1,null,null,null);e["a"]=l.exports},"1dde":function(t,e,n){var a=n("d039"),o=n("b622"),i=n("2d00"),s=o("species");t.exports=function(t){return i>=51||!a((function(){var e=[],n=e.constructor={};return n[s]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},"44e7":function(t,e,n){var a=n("861d"),o=n("c6b6"),i=n("b622"),s=i("match");t.exports=function(t){var e;return a(t)&&(void 0!==(e=t[s])?!!e:"RegExp"==o(t))}},"45fc":function(t,e,n){"use strict";var a=n("23e7"),o=n("b727").some,i=n("a640"),s=n("ae40"),r=i("some"),l=s("some");a({target:"Array",proto:!0,forced:!r||!l},{some:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}})},8418:function(t,e,n){"use strict";var a=n("c04e"),o=n("9bf2"),i=n("5c6c");t.exports=function(t,e,n){var s=a(e);s in t?o.f(t,s,i(0,n)):t[s]=n}},8785:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"items"},[n("table",{staticClass:"table table-striped"},[n("thead",[n("tr",[t._l(t.columns,(function(e){return n("th",{key:e.name,attrs:{scope:"col"}},[t._v(t._s(e.label))])})),n("th",{attrs:{scope:"col"}},[t._v("是否啟用")]),n("th",{attrs:{scope:"col"}},[t._v("編輯")])],2)]),n("tbody",t._l(t.items,(function(e){return n("tr",{key:e.id},[t._l(e,(function(a,o){return n("td",{directives:[{name:"show",rawName:"v-show",value:t.showColumn(o),expression:"showColumn(name)"}],key:o,attrs:{scope:"row"}},[n("span","deadline"===o?[t._v(t._s(e[o].datetime))]:[t._v(t._s(e[o]))])])})),n("td",{class:e.enabled?"text-success":"text-danger",attrs:{scope:"row"}},[t._v(t._s(e.enabled?"啟用":"停用"))]),n("td",{attrs:{scope:"row"}},[n("button",{staticClass:"btn btn-outline-primary btn-sm",attrs:{"data-toggle":"modal",type:"button"},on:{click:function(n){return t.$emit("open-modal",{item:e,isNew:!1})}}},[t._v("編輯")]),n("button",{staticClass:"btn btn-outline-danger btn-sm",attrs:{"data-toggle":"modal","data-target":"#confirm-delete",type:"button"},on:{click:function(n){return t.$emit("comfirm-delete",e.id)}}},[t._v("刪除")]),n("button",{staticClass:"btn btn-outline-primary btn-sm",attrs:{type:"button"},on:{click:function(n){return t.$emit("duplicate",e)}}},[t._v("複製")])])],2)})),0)])])},o=[],i=(n("45fc"),n("b0c0"),{props:["items","columns"],methods:{showColumn:function(t){return this.columns.some((function(e,n){return e.name===t}))}}}),s=i,r=n("2877"),l=Object(r["a"])(s,a,o,!1,null,null,null);e["a"]=l.exports},"93c1":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("dash-board",{attrs:{"btn-loading":t.btnLoading,"btn-create":"新增優惠券"},on:{"open-modal":t.openModal,"delete-item":t.deleteCoupon},scopedSlots:t._u([{key:"list",fn:function(){return[n("list-table",{attrs:{items:t.coupons,columns:t.columns},on:{"open-modal":t.openModal,"comfirm-delete":function(e){(function(){t.couponIdToBeDelete=e,t.$bvModal.show("confirm-delete")})()}}}),n("pagination",{attrs:{pagination:t.pagination},on:{"emit-page":t.getCoupons}}),n("coupon-modal",{ref:"CouponModal",attrs:{loading:t.btnLoading},on:{"save-coupon":t.saveCoupon}})]},proxy:!0}])})],1)},o=[],i=(n("99af"),n("ac1f"),n("1276"),n("c7bd")),s=n("8785"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{id:"coupon-modal","hide-footer":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(" "+t._s(t.isNew?"新增優惠券":"編輯優惠券")+" ")]},proxy:!0}])},[n("div",{staticClass:"modal-content"},[n("div",{staticClass:"modal-body"},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"title"}},[t._v("標題")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.title,expression:"tempCoupon.title"}],staticClass:"form-control",attrs:{id:"title",type:"text",placeholder:"請輸入標題",required:""},domProps:{value:t.tempCoupon.title},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"title",e.target.value)}}})]),n("div",{staticClass:"form-row"},[n("div",{staticClass:"form-group col-md-6"},[n("label",{attrs:{for:"code"}},[t._v("優惠碼")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.code,expression:"tempCoupon.code"}],staticClass:"form-control",attrs:{id:"code",type:"text",placeholder:"請輸入優惠碼",required:""},domProps:{value:t.tempCoupon.code},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"code",e.target.value)}}})]),n("div",{staticClass:"form-group col-md-6"},[n("label",{attrs:{for:"percent"}},[t._v("折扣百分比")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.percent,expression:"tempCoupon.percent"}],staticClass:"form-control",attrs:{id:"percent",type:"number",placeholder:"折扣百分比",required:""},domProps:{value:t.tempCoupon.percent},on:{input:function(e){e.target.composing||t.$set(t.tempCoupon,"percent",e.target.value)}}})])]),n("div",{staticClass:"form-row"},[n("div",{staticClass:"form-group col-md-6"},[n("label",{attrs:{for:"deadlineDate"}},[t._v("到期日")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.deadlineDate,expression:"deadlineDate"}],staticClass:"form-control",attrs:{id:"deadlineDate",type:"date",placeholder:"到期日",required:""},domProps:{value:t.deadlineDate},on:{input:function(e){e.target.composing||(t.deadlineDate=e.target.value)}}})]),n("div",{staticClass:"form-group col-md-6"},[n("label",{attrs:{for:"deadlineTime"}},[t._v("到期時間")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.deadlineTime,expression:"deadlineTime"}],staticClass:"form-control",attrs:{id:"deadlineTime",type:"time",placeholder:"到期日",required:"",step:"1"},domProps:{value:t.deadlineTime},on:{input:function(e){e.target.composing||(t.deadlineTime=e.target.value)}}})])]),n("hr"),n("div",{staticClass:"form-group"},[n("div",{staticClass:"form-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.tempCoupon.enabled,expression:"tempCoupon.enabled"}],staticClass:"form-check-input",attrs:{id:"enabled",type:"checkbox"},domProps:{checked:Array.isArray(t.tempCoupon.enabled)?t._i(t.tempCoupon.enabled,null)>-1:t.tempCoupon.enabled},on:{change:function(e){var n=t.tempCoupon.enabled,a=e.target,o=!!a.checked;if(Array.isArray(n)){var i=null,s=t._i(n,i);a.checked?s<0&&t.$set(t.tempCoupon,"enabled",n.concat([i])):s>-1&&t.$set(t.tempCoupon,"enabled",n.slice(0,s).concat(n.slice(s+1)))}else t.$set(t.tempCoupon,"enabled",o)}}}),n("label",{staticClass:"form-check-label",attrs:{for:"enabled"}},[t._v("是否啟用")])])])]),n("div",{staticClass:"modal-footer"},[n("button",{staticClass:"btn btn-secondary",attrs:{disabled:t.loading,type:"button","data-dismiss":"modal"},on:{click:function(e){return t.$bvModal.hide("coupon-modal")}}},[t._v("取消")]),t.loading?n("button",{staticClass:"btn btn-primary",attrs:{type:"button"}},[n("i",{staticClass:"fas fa-spinner fa-spin"}),t._v(" 儲存中... ")]):n("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.saveCoupon}},[t._v("確認")])])])])},l=[],c={props:["loading"],data:function(){return{deadlineDate:"",deadlineTime:"",tempCoupon:{title:"",percent:"",deadline_at:"",code:"",enabled:!1},isNew:!1}},created:function(){},methods:{saveCoupon:function(){this.$set(this.tempCoupon,"deadline_at",this.deadline_at),this.$emit("save-coupon",{coupon:this.tempCoupon,isNew:this.isNew})}},computed:{deadline_at:function(){return this.deadlineDate+" "+this.deadlineTime}}},d=c,u=n("2877"),p=Object(u["a"])(d,r,l,!1,null,null,null),m=p.exports,f=n("1799"),v={data:function(){return{api:"https://course-ec-api.hexschool.io/api",UUID:"354b1b67-8c78-4eab-a8f1-148bbb2f3ec1",coupons:{},pagination:{total:0,count:1,per_page:25,current_page:1,total_pages:1,links:[]},couponIdToBeDelete:"",btnLoading:!1,columns:[{name:"title",label:"名稱"},{name:"percent",label:"折扣百分比"},{name:"deadline",label:"到期日"}]}},created:function(){this.getCoupons()},components:{DashBoard:i["a"],ListTable:s["a"],CouponModal:m,Pagination:f["a"]},methods:{getCoupons:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.$bus.$emit("show-overlay",!0);var n="".concat(this.api,"/").concat(this.UUID,"/admin/ec/coupons");this.axios.get(n,{params:{page:e,paged:5}}).then((function(e){console.log(e.data.data),t.coupons=e.data.data,t.pagination=e.data.meta.pagination,t.$bus.$emit("show-overlay",!1)})).catch((function(e){console.dir(e),401===e.request.status&&alert("請先登入"),t.$bus.$emit("show-overlay",!1)}))},openModal:function(t){var e=t.item,n=t.isNew;if(this.$bvModal.show("coupon-modal"),n)this.$refs.CouponModal.tempCoupon={title:"",percent:"",deadline_at:"",code:"",enabled:!1},this.$refs.CouponModal.deadlineDate="",this.$refs.CouponModal.deadlineTime="",this.$refs.CouponModal.isNew=!0;else{this.$refs.CouponModal.isNew=!1,this.$refs.CouponModal.tempCoupon=Object.assign({},e);var a=e.deadline.datetime.split(" ");console.log(a),this.$refs.CouponModal.deadlineDate=a[0],this.$refs.CouponModal.deadlineTime=a[1]}},saveCoupon:function(t){var e=this,n=t.coupon,a=t.isNew;console.log("save coupon",n,a),this.btnLoading=!0;var o="",i="";a?(i="post",o="".concat(this.api,"/").concat(this.UUID,"/admin/ec/coupon")):(i="patch",o="".concat(this.api,"/").concat(this.UUID,"/admin/ec/coupon/").concat(n.id)),this.axios({method:i,url:o,data:n}).then((function(t){console.log(t),e.btnLoading=!1,e.getCoupons(),e.$bvModal.hide("coupon-modal")})).catch((function(t){console.dir(t),e.btnLoading=!1,e.$bvModal.hide("coupon-modal"),alert("儲存失敗，請洽管理員")}))},deleteCoupon:function(){var t=this;this.btnLoading=!0;var e="".concat(this.api,"/").concat(this.UUID,"/admin/ec/coupon/").concat(this.couponIdToBeDelete);this.axios.delete(e).then((function(e){t.$bvModal.hide("confirm-delete"),t.btnLoading=!1,t.getCoupons()})).catch((function(e){t.$bvModal.hide("confirm-delete"),t.btnLoading=!1,console.log(e)}))}}},h=v,b=Object(u["a"])(h,a,o,!1,null,null,null);e["default"]=b.exports},"99af":function(t,e,n){"use strict";var a=n("23e7"),o=n("d039"),i=n("e8b5"),s=n("861d"),r=n("7b0b"),l=n("50c4"),c=n("8418"),d=n("65f0"),u=n("1dde"),p=n("b622"),m=n("2d00"),f=p("isConcatSpreadable"),v=9007199254740991,h="Maximum allowed index exceeded",b=m>=51||!o((function(){var t=[];return t[f]=!1,t.concat()[0]!==t})),g=u("concat"),C=function(t){if(!s(t))return!1;var e=t[f];return void 0!==e?!!e:i(t)},_=!b||!g;a({target:"Array",proto:!0,forced:_},{concat:function(t){var e,n,a,o,i,s=r(this),u=d(s,0),p=0;for(e=-1,a=arguments.length;e<a;e++)if(i=-1===e?s:arguments[e],C(i)){if(o=l(i.length),p+o>v)throw TypeError(h);for(n=0;n<o;n++,p++)n in i&&c(u,p,i[n])}else{if(p>=v)throw TypeError(h);c(u,p++,i)}return u.length=p,u}})},b0c0:function(t,e,n){var a=n("83ab"),o=n("9bf2").f,i=Function.prototype,s=i.toString,r=/^\s*function ([^ (]*)/,l="name";a&&!(l in i)&&o(i,l,{configurable:!0,get:function(){try{return s.call(this).match(r)[1]}catch(t){return""}}})},c7bd:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container mt-3"},[n("div",{staticClass:"col mx-auto text-center mx-auto"},[n("div",{staticClass:"text-right"},[n("button",{staticClass:"add-new-product btn btn-primary",attrs:{"data-toggle":"modal","data-target":"#product-modal"},on:{click:function(e){return t.$emit("open-modal",{item:null,isNew:!0})}}},[t._v(" "+t._s(t.btnCreate)+" ")])]),t._t("list")],2),n("confirm-delete",{attrs:{btnLoading:t.btnLoading},on:{"delete-item":function(e){return t.$emit("delete-item")}}})],1)},o=[],i=n("fa9b"),s={props:["btnLoading","btnCreate"],components:{ConfirmDelete:i["a"]}},r=s,l=n("2877"),c=Object(l["a"])(r,a,o,!1,null,null,null);e["a"]=c.exports},fa9b:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-modal",{attrs:{id:"confirm-delete","hide-footer":""},scopedSlots:t._u([{key:"modal-title",fn:function(){return[t._v(" 刪除確認 ")]},proxy:!0}])},[n("div",{staticClass:"d-block text-center"},[n("h3",[t._v("確認刪除這個項目嗎？")])]),n("div",{staticClass:"d-flex justify-content-end"},[n("b-button",{directives:[{name:"show",rawName:"v-show",value:t.btnLoading,expression:"btnLoading"}],attrs:{variant:"primary",disabled:""}},[n("b-spinner",{attrs:{small:""}}),n("span",[t._v("Loading...")])],1),n("b-button",{directives:[{name:"show",rawName:"v-show",value:!t.btnLoading,expression:"!btnLoading"}],staticClass:"mt-3",attrs:{variant:"primary"},on:{click:function(e){return t.$bvModal.hide("confirm-delete")}}},[t._v("取消")]),n("b-button",{directives:[{name:"show",rawName:"v-show",value:!t.btnLoading,expression:"!btnLoading"}],staticClass:"mt-3 ml-3",attrs:{variant:"primary"},on:{click:function(e){return t.$emit("delete-item")}}},[t._v("確定")])],1)])],1)},o=[],i={props:["btnLoading"]},s=i,r=n("2877"),l=Object(r["a"])(s,a,o,!1,null,null,null);e["a"]=l.exports}}]);
//# sourceMappingURL=chunk-759de5fc.c3389dfe.js.map